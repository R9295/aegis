<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Add Note  |  name_of_user</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link href="{{url_for('static', filename='add_note.css')}}" type="text/css" rel="stylesheet">
    <link href="{{url_for('static', filename='common.css')}}" type="text/css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/simplemde/1.11.2/simplemde.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/atrament.js/0.2.3/atrament.min.js"></script>
  </head>
  <body>
    
    
    
    <br><br>
      
      
    
    <div class="form-group">
      <label for="name">Title</label>
      <input type="text" id="title" class="form-control col-lg-6">
    </div>
    <br><br>
    

    <div class="form-group">    

     <div id="input_div">
        <br><br>
       <textarea name="" rows="15" id="input"></textarea>
      </div> 

      </div>
      
    <div align="right">
    <br><br>
      <br><br>
     
    <button class="btn btn-md btn-success" onclick="post_data()">Save</button>
    <button class="btn btn-md btn-danger">Discard</button>
    </div>
    <br><br>

    

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplemde/1.11.2/simplemde.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pouchdb/6.3.4/pouchdb.min.js"></script>

    <script>
    db =  new PouchDB('session')

  var simplemde = new SimpleMDE({
   element: document.getElementById("input"),
   spellChecker:false

 });
 
  //Gathering form data,encrypting and posting
  function post_data(){

      
      
      db.get('session_data').then(function(doc){
      //gathering data
      var data = {}
      data['type'] = 'text'
      data['title'] =$("#title").val()
      data['note'] = simplemde.value()
      data['id'] = doc.uuid
      data = JSON.stringify(data)
         $.ajax({
        type: "POST",
        url: "/add_note",
        contentType: 'application/json',
        data: data,
        dataType: 'json',
        success: function success(data){
          console.log(data.response)
        
        },

      });
      

      }).catch(function(err){
       console.log(err) 
      })
      


      
    }


    
    

  </script>
  </body>
</html>